(()=>{"use strict";function t(t){const e=Math.floor(t/3600),n=Math.floor(t%3600/60),a=Math.round(t%60);return[e,n>9?n:e?"0"+n:n||"0",a>9?a:"0"+a].filter(Boolean).join(":")}const e={selections:{},statistics:{characters:[],locations:[],scenes:[]}};function n(t="root-panel"){return document.getElementById("root-panel")}function a(t,n,a){return s=>{e.selections[t]=a[n-1],function(t,n,a){const s=document.querySelector("vscode-panel-view#view-characters");s&&(s.getElementsByTagName("h3")[0].innerHTML=e.selections[t].Name)}(t)}}function s(t,e){const n=(s=t,document.getElementById(s));var s;n.rowsData=e,setTimeout((()=>{const s=n.getElementsByTagName("vscode-data-grid-row");for(let n=0;n<s.length;++n)s[n].addEventListener("click",a(t,n,e))}),1)}function o(e,n){const a=e,s=1-a;return a>s?`${t(n)} (${Math.round(100*a).toFixed(0)}% Dialogue)`:s>a?`${t(n)} (${Math.round(100*s).toFixed(0)}% Action)`:`${t(n)} (Balanced Action / Dialogue)`}window.addEventListener("load",(function(){})),window.addEventListener("message",(function(a){"fountain.statistics.characters"==a.data.command&&(e.statistics.characters=a.data.stats,function(e){s("grid-characters",e.map((e=>({Name:e.Name,Gender:e.Gender.toUpperCase(),"Length & Duration":`${t(e.Duration)} - ${e.Lines} lines - ${e.Words} words`,"Reading Age":e.ReadingAge}))));const n=document.querySelector("vscode-panel-tab#tab-characters > vscode-badge");n&&(n.innerHTML=""+e.length);let a=0;const o={};for(const t of e){const e=t;o[e.Gender]=(o[e.Gender]||0)+(e.Duration||0),a+=e.Duration||0}const c=[];for(const e in o)c.push(`${e} characters speak for ${t(o[e])} (${Math.round(o[e]/a*100)}%)`);document.getElementById("characters-observations").innerHTML=c.join("<br />")}(e.statistics.characters)),"fountain.statistics.locations"==a.data.command&&(e.statistics.locations=a.data.stats,function(e){s("grid-locations",e.map((e=>Object.assign(Object.assign({},e),{Duration:t(e.Duration)}))));const n=document.querySelector("vscode-panel-tab#tab-locations > vscode-badge");n&&(n.innerHTML=""+e.length)}(e.statistics.locations)),"fountain.statistics.scenes"==a.data.command&&(e.statistics.scenes=a.data.stats,function(t){s("grid-scenes",t.map((t=>{const e=t.DialogueDuration/t.Duration;return{Name:t.Name,Characters:t.Characters,Synopsis:t.Synopsis,Duration:o(e,t.Duration)}})));const e=document.querySelector("vscode-panel-tab#tab-scenes > vscode-badge");e&&(e.innerHTML=""+t.length)}(e.statistics.scenes)),"fountain.analyseLocation"==a.data.command&&(n().activeid="tab-locations"),"fountain.analyseCharacter"==a.data.command&&(n().activeid="tab-characters"),"fountain.analyseScene"==a.data.command&&(n().activeid="tab-scenes")}))})();